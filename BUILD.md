# Building @live2ride/db

This package is written in TypeScript and needs to be compiled before use.

## Setup

1. Install dependencies (run from this directory):
```bash
npm install
```

## Building

To compile the TypeScript source to JavaScript:

```bash
npm run build
```

This will create a `dist/` folder with the compiled JavaScript files and TypeScript declaration files.

## Auto-build in Parent Project

The parent project (`f:\www\sql`) automatically builds this package when you run:

```bash
npm run build
```

The build process runs `build:db` before `build:renderer`.

## Development

The package structure:
- `index.ts` - Main DB class
- `types.ts` - TypeScript type definitions
- `classes/` - Error classes and utilities
- `utils/` - Helper functions
- `dist/` - Compiled output (generated by build, git-ignored)

## Using in the Electron App

The compiled package is loaded by the Electron main process from `src/modules/db/dist/index.js`.

In development mode (using tsx), the TypeScript files are loaded directly.
In production mode (packaged app), the compiled JavaScript is used.

## Publishing to npm

Before publishing to npm:

```bash
npm run build
npm publish
```

The `prepublishOnly` script will automatically run the build before publishing.

## Using in Other Projects

After publishing, other projects can install and use this package:

```bash
npm install @live2ride/db
```

```javascript
const DB = require('@live2ride/db');
const db = new DB.default({
  server: 'your-server',
  database: 'your-database',
  user: 'your-user',
  password: 'your-password'
});

// Use the db instance
const results = await db.exec('SELECT * FROM Users WHERE id = @_id', { id: 123 });
```

## Local Development with npm link

To use this package in another project during development:

```bash
# In this directory (src/modules/db)
npm link

# In your other project directory
npm link @live2ride/db
```

Don't forget to rebuild after making changes:
```bash
npm run build
```
